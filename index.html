<!DOCTYPE html>
<html>
  <head>
	<meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<title>UPLCC</title>
  </head>
  <body>	
<div id="top-d" class="top-d">
<span id="ex" class="ex" onclick="exitCode();">返回</span>
<span id="cza" class="cza" onclick="cz();">重置UI</span>
<span id="go" class="go" onclick="goto();">开源</span>
<span id="down" class="down" onclick="filex();">文件</span>
<span id="run" class="run" onclick="runCode();">运行</span>
</div>
<div id="filec" class="filec">
<p id="bc" class="bc" onclick="downLo();">保存</p>
<p id="dra" class="dra" onclick="fileRe();">导入</p>
<input type="file" id="xzfile" class="xzfile" style="display:none;"/>
</div>
<div id="fileq" class="fileq" onclick="if(iffile){filex();}"></div>
<div id="ts" class="ts"><p id="tsp" class="tsp"></p></div>
<textarea id="tex" class="tex" oninput="ale();"></textarea>
<iframe id="runt" class="runt"></iframe>
<div id="p" class="p">
<span id="p1" onclick="plus='<';pluss(plus);" class="pl"><</span>
<span id="p2" onclick="plus='>';pluss(plus);" class="pl">></span>
<span id="p3" onclick="plus=this.innerHTML;pluss(plus);" class="pl">/</span>
<span id="p4" onclick="plus=this.innerHTML;pluss(plus);" class="pl">=</span>
<span id="p5" onclick="plus=this.innerHTML;pluss(plus);" class="pl">"</span>
<span id="p6" onclick="plus=this.innerHTML;pluss(plus);" class="pl">:</span>
<span id="p7" onclick="plus=this.innerHTML;pluss(plus);" class="pl">;</span>
<span id="p8" onclick="plus=this.innerHTML;pluss(plus);" class="pl">(</span>
<span id="p9" onclick="plus=this.innerHTML;pluss(plus);" class="pl">)</span>
<span id="p10" onclick="plus=this.innerHTML;pluss(plus);" class="pl">{</span>
<span id="p11" onclick="plus=this.innerHTML;pluss(plus);" class="pl">}</span>
<span id="p12" onclick="plus=this.innerHTML;pluss(plus);" class="pl">[</span>
<span id="p13" onclick="plus=this.innerHTML;pluss(plus);" class="pl">]</span>
<span id="p14" onclick="plus=this.innerHTML;pluss(plus);" class="pl">%</span>
<span id="p15" onclick="plus=this.innerHTML;pluss(plus);" class="pl">!</span>
<span id="p16" onclick="plus=this.innerHTML;pluss(plus);" class="pl">_</span>
<span id="p17" onclick="plus=this.innerHTML;pluss(plus);" class="pl">-</span>
<span id="p18" onclick="plus=this.innerHTML;pluss(plus);" class="pl">*</span>
<span id="p19" onclick="plus=this.innerHTML;pluss(plus);" class="pl">'</span>
<span id="p20" onclick="plus=this.innerHTML;pluss(plus);" class="pl">\</span>
<span id="p21" onclick="plus=this.innerHTML;pluss(plus);" class="pl">`</span>
</div>
  </body>
<style>
*{
margin:0;
padding:0;
}
body{
background-color:rgba(0,0,0,0.8);
}
.top-d{
position:fixed;
z-index:900;
width:100vw;
height:25px;
background-color:rgba(255,255,255,0.1);
color:white;
}
.tex{
position:fixed;
z-index:100;
top:25px;
background-color:rgba(255,255,255,0.2);
width:100vw;
height:100vh;
color:white;
border:0px solid white;
padding:5px;
font-size:15px;
line-height:20px;
}
.runt{
position:fixed;
z-index:500;
width:100vw;
height:100vh;
background-color:white;
border:0px solid white;
display:none;
top:25px;
}
.run{
position:absolute;
left:85%;
font-size:15px;
height:15px;
top:10%;
}
.ex{
position:absolute;
left:1%;
top:10%;
display:none;
}
.cza{
position:absolute;
left:15%;
top:10%;
}
@keyframes runa{
0%{
opacity:0;
}to{
opacity:1;
}
}
@keyframes runb{
0%{
opacity:1;
}to{
opacity:0;
}
}
.ts{
position:fixed;
z-index:700;
top:35px;
right:20px;
min-height:10px;
color:white;
padding:3px;
width:130px;
background-color:rgba(255,255,255,0.3);
backdrop-filter:blur(3px);
border:2px solid white;
border-radius:10px;
display:none;
max-height:150px;
overflow-y:auto;
}
.go{
position:absolute;
left:35%;
top:10%;
}
.down{
position:absolute;
left:50%;
top:10%;
}
.p{
position:fixed;
bottom:0;
width:100vw;
height:30px;
background-color:rgba(255,255,255,0.1);
z-index:101;
color:white;
overflow-x:auto;
white-space:nowrap;
}
.pl{
padding:5px;
margin:5px;
font-size:20px;
}
.filec{
position:fixed;
z-index:999;
width:130px;
background-color:rgba(255,255,255,0.3);
border:3px solid white;
border-radius:10px;
backdrop-filter:blur(3px);
top:30px;
left:50%;
color:white;
padding:5px;
display:none;
}
.fileq{
position:fixed;
z-index:949;
width:100vw;
height:100vh;
opacity:0;
display:none;
}
</style>
<script src="uxb.js"></script>
<script>
let plus;
function cz(){
pd=0;
runt.style.height=window.innerHeight-25+"px";
tex.style.height = window.innerHeight - 65 + 'px';
tex.style.width  = window.innerWidth - 5  + 'px';
}
let pd=0;
setInterval(()=>{
if(window.innerHeight-25>pd){
pd=window.innerHeight-25;
}
if(pd%1!==0){
pd=Math.round(pd);
}
runt.style.height=pd+"px";
},500);
window.addEventListener('resize', () => {
  tex.style.height = window.innerHeight - 65 + 'px';
  tex.style.width  = window.innerWidth - 5  + 'px';
});
tex.value=`<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>UPLCC</title>
</head>
<script src="uxb.js"><\/script>
<body>
<h1>Hello World!</h1>
</body>
</html>`;
let yxif=false;
setInterval(()=>{
if(yxif){
ex.style.display="block";
}else{
run.style.display="block";
}
},1000);
function runCode(){
yxif=true;
ts.style.display="none";
runt.style.display="block";
runt.style.animationName="runa";
runt.style.animationDuration="0.3s";
ex.style.display="block";
ex.style.animationName="runa";
ex.style.animationDuration="0.3s";
run.style.animationName="runb";
run.style.animationDuration="0.3s";
setTimeout(()=>{
run.style.display="none";
},300);
runt.srcdoc=tex.value;
}
function exitCode(){
yxif=false;
runt.style.animationName="runb";
runt.style.animationDuration="0.3s";
ex.style.animationName="runb";
ex.style.animationDuration="0.3s";
setTimeout(()=>{
runt.style.display="none";
ex.style.display="none";
},300);
run.style.display="block";
run.style.animationName="runa";
run.style.animationDuration="0.3s";
}
let fh="";
const hasha = [
"alert",
"console.log",
"for","while",
"if","else",
"function",
"setInterval",
"setTimeout",
"style",
"animationName",
"animationDuration",
"document",
"getElementById",
"innerHTML",
"innerText",
"requestAnimationFrame",
"window.location.href",
"window.prompt",
"localStorage.setItem",
"localStorage.getItem",
"localStorage.removeItem",
"localStorage.key",
"appendChild",
"length",
"split",
"replace",
"toFixed",
"Math.random",
"Math.floor",
"Math.round",
"var",
"let",
"const",
"true",
"false",
"src",
"addEventListener",
"return",
"push",
"pop",
"splice",
"substr",
"window.open",
"window.confirm",
"grid-columns(CSS)",
"@keyframes(CSS)",
"@font-face(CSS)",
"width(CSS)",
"height(CSS)",
"border(CSS)",
"border-radius(CSS)",
"position(CSS)",
"display(CSS)",
"margin(CSS)",
"margin-top(CSS)",
"margin-bottom(CSS)",
"margin-left(CSS)",
"margin-top(CSS)",
"padding(CSS)",
"padding-left(CSS)",
"padding-top(CSS)",
"padding-bottom(CSS)",
"padding-right(CSS)",
"z-index(CSS)",
"min-width(CSS)",
"max-width(CSS)",
"min-height(CSS)",
"max-height(CSS)",
"filter(CSS)",
"backdrop-filter(CSS)",
"top(CSS)",
"left(CSS)",
"right(CSS)",
"bottom(CSS)",
"fixed(CSS属性)",
"center(CSS属性)",
"auto(CSS属性)",
"opacity(CSS)",
"overflow(CSS)",
"overflow-x(CSS)",
"overflow-y(CSS)",
"font-size(CSS)",
"color(CSS)",
"absolute(CSS属性)",
"flex(CSS属性)",
"grid(CSS属性)",
"text-align(CSS)",
"transform(CSS)",
"relative(CSS属性)",
"none(CSS属性)",
"placeholder(属性)",
"onclick(属性)",
"id(属性)",
"class(属性)",
"oninput(属性)",
"type(属性)",
"alt(属性)",
"data-*(属性)",
"style(属性)",
"h1(HTML)",
"h2(HTML)",
"h3(HTML)",
"h4(HTML)",
"h5(HTML)",
"h6(HTML)",
"html(HTML)",
"p(HTML)",
"pre(HTML)",
"s(HTML)",
"div(HTML)",
"form(HTML)",
"input(HTML)",
"button(HTML)",
"iframe(HTML)",
"hr(HTML)",
"br(HTML)",
"ins(HTML)",
"a(HTML)",
"nav(HTML)",
"rp(HTML)",
"rt(HTML)",
"sub(HTML)",
"sup(HTML)",
"audio(HTML)",
"table(HTML)",
"b(HTML)",
"i(HTML)",
"u(HTML)",
"ul(HTML)",
"ol(HTML)",
"code(HTML)",
"video(HTML)",
"mark(HTML)",
"span(HTML)",
"label(HTML)",
"src(属性)",
"img(HTML)",
"href(HTML)",
"canvas(HTML)",
"em(HTML)",
"q(HTML)",
"center(HTML)",
"value(属性)",
"background-color(CSS)",
"background-img(CSS)",
"uxb.ale(uxb)",
"uxb.conlog(uxb)",
"uxb.locset(uxb)",
"uxb.locget(uxb)",
"uxb.locrem(uxb)",
"uxb.loccle(uxb)",
"uxb.locof(uxb)",
"uxb.write(uxb)",
"uxb.prom(uxb)",
"uxb.goTo(uxb)",
"uxb.lockey(uxb)",
"uxb.jza(uxb)",
"uxb.jzb(uxb)",
"uxb.err(uxb)",
"uxb.va(uxb)",
"uxb.idinnerHTML(uxb)",
"script(HTML)",
"style(HTML)",
"link(HTML)"
];
function ale() {
  fh = "";
  ts.style.display = "none";
  const text = tex.value;
  const pos  = tex.selectionStart;
  if (pos == null) return;
  const left = text.slice(0, pos);
  const m = left.match(/([a-zA-Z0-9.\-_/]+)$/);
  if (!m) return;
  const cur = m[1];
  const matched = hasha.filter(w => w.toLowerCase().startsWith(cur.toLowerCase()));
  if (!matched.length) return;
  fh = matched.join('<br>');
  document.getElementById('tsp').innerHTML = fh;
  ts.style.display = 'block';
  const nextChar = text[pos];
  if (nextChar === ' ' || nextChar === ',') {
    ts.style.display = 'none';
  }
}
function goto(){
const gita=window.open("https://github.com/UPLCC/code","_blank");
if(gita){
gita.opener=null;
}
}
function pluss(plus) {
  const tex = document.getElementById('tex');
  const posss = tex.selectionStart;
  const before = tex.value.slice(0, posss);
  const after = tex.value.slice(posss);
  tex.value = before + plus + after;
  tex.selectionStart = tex.selectionEnd = posss + plus.length;
  tex.focus();
}
let coda,userprom;
function downLo(){
filex();
coda=tex.value;
userprom=window.prompt("文件名");
if(!userprom||!coda){
alert("文件名或代码为空");
return;
}
if(!userprom.endsWith(".html")){
userprom+=".html";
}
const blob = new Blob([coda], { type: 'text/html;charset=utf-8' });
  const urlaa = URL.createObjectURL(blob);
  const aaa = document.createElement('a');
  aaa.href = urlaa;
  aaa.download = userprom;
  aaa.style.display = 'none';
  document.body.appendChild(aaa);
  aaa.click();
  document.body.removeChild(aaa);
  URL.revokeObjectURL(urlaa);
}
let iffile=false;
function filex(){
if(!iffile){
fileq.style.display="block";
filec.style.display="block";
filec.style.animationName="runa";
filec.style.animationDuration="0.3s";
iffile=true;
}else{
fileq.style.display="none";
filec.style.animationName="runb";
filec.style.animationDuration="0.3s";
setTimeout(()=>{
filec.style.display="none";
iffile=false;
},300);
}
}
function fileRe(){
xzfile.click();
filex();
}
document.getElementById("xzfile").addEventListener("change",(event)=>{
const filel=event.target.files[0];
const reader=new FileReader();
reader.onload=function (e){
filetext=e.target.result;
tex.value=filetext;
}
reader.readAsText(filel);
});
</script>
</html>
